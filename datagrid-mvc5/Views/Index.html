
<!DOCTYPE html>

<html>
<head>
    <title>eeee</title>
    <script src="../../Scripts/iqery.min.js"></script>
    <script src="../../Scripts/dx.all.js"></script>
    <script src="../../Scripts/dx.aspnet.data.js"></script>
    <script src="../../js/code2.js"></script>
    <link rel="stylesheet" type="text/css" href="../../Content/dx.common.css" />
    <link rel="stylesheet" type="text/css" href="../../Content/grey.css" />
</head>
<script>
    var dataGrid;
    var filterA = new Array();
    var filterB = new Array();
    var filterC = new Array();
    function init() {

        dataGrid = $('#grid').dxDataGrid('instance');
     //   $("#selectStatus").dxSelectBox({//комбо бокс выбора страны
     //       dataSource: statuses,
     //       value: statuses[0],
     //       onValueChanged: function (data) {
     //           if (data.value == "All") {
     //               filterB.length = 0;
     //               ApplayFilterChanges();
     //           }
     //           else {
     //               filterB[0] = ["ShipCountry", "=", data.value]
     //               ApplayFilterChanges();
     //           }
     //       }
     //   });

        setDataSource();
    }


    function Filter1() {
        filterA[0] = [["OrderID", ">", "400"], "and", ["OrderID", '<', "10250"]];
        ApplayFilterChanges();
    }



    function FilterStatus(status) {
        var filter = ["ShipCountry", "=", status];
        dataGrid.filter(filter);
        dataGrid.refresh();
        console.time("x");
    }

    function CreateFilter() {
        var filtElem = document.getElementById("filter");

        var dataGridInstance = $("#grid").dxDataGrid("instance");

        const table = document.createElement('table');
        filtElem.appendChild(table);
        //create fields
        for (var i = 0; i < dataGridInstance.columnCount(); i++) {

            row = document.createElement('tr');
            table.appendChild(row);

            var column = dataGridInstance.columnOption(i);

            //label
            textnode = document.createTextNode(column.caption);

            //checkbox
            checkBox = document.createElement("input");
            checkBox.setAttribute('type', 'checkbox');
            checkBox.setAttribute('id', 'checkbox_' + column.caption);

            //input
            input = document.createElement("input")
            input.setAttribute('id', 'input_' + column.caption);

            createTableСell(row, textnode);
            createTableСell(row, checkBox);
            createTableСell(row, input);
        }
        row = document.createElement('tr');

        table.appendChild(row);
        findButton = document.createElement("button");
        findButton.setAttribute('onclick', 'FilterFind()');
        findButton.textContent = 'найти';
        createTableСell(row);
        createTableСell(row);
        createTableСell(row, findButton);
        //cell.setAttribute('COLSPAN','3');
    }
    function FilterFind() {
        //for ( i = 0;i<10);
    }

    function createTableСell(row, el) {
        td = document.createElement("td");
        if (el != null) { td.appendChild(el); }
        row.appendChild(td);
        return td;
    }


    //соединение массивов фильтров
    function ApplayFilterChanges() {
        var filter = ConcatFilterArr(filterA, filterB);
        filter = ConcatFilterArr(filter, filterC);
        dataGrid.filter(filter);
        dataGrid.refresh();
        console.time("x");
    }
    function ConcatFilterArr(filterArr1, filterArr2) {
        if (filterArr1.length > 0 && filterArr2.length > 0) {
            var res = new Array();
            res[0] = filterArr1;
            res[1] = "and";
            res[2] = filterArr2;
            return res;
        }
        else {
            if (filterArr1.length > 0) {
                return filterArr1
            }
            else {
                return filterArr2
            }
        }
    }


    function FilterClear() {
        filterA.length = 0;
        filterB.length = 0;
        filterC.length = 0;
        dataGrid.clearFilterStatus();

    }
    function find() {
        filterC.length = 0;
        var check = document.getElementById("IdFilterCheck").checked;
        if (!check) return;

        var inpVal = document.getElementById("inpIdFilter").value;
        inpVal = inpVal.replace(/\s/g, '').replace(/,+/g, ',');
        var arr = inpVal.split(',');
        if (arr.length == 1 && arr[0] == '') { } else {
            for (f = 0, i = 0; i < arr.length; i++ , f++) {
                filterC[f] = ["OrderID", "=", arr[i]];
                if (arr.length - 1 > i) {
                    f++;
                    filterC[f] = 'or'
                }
            }
        }
        ApplayFilterChanges();
    }


</script>
<body onload="init()">
    <span>Header</span>
    <div id="filter"  style="background-color:lightblue">dsds</div>>
    <br />
    <button onclick="CreateFilter()">CreateFilter</button>
    <button onclick='FilterStatus("All")'>All</button>
    <button onclick='FilterStatus("Switzerland")'>Switzerland</button>
    <button onclick='FilterStatus("Belgium")'>Belgium</button>
    <button onclick='FilterStatus("Brazil")'>Brazil</button>
    <button onclick='FilterStatus("Germany")'>Germany</button>

    <button onclick="FilterClear()">FilterClear</button>
    <button onclick="find()">найти</button>
    <br />
    <div id="grid"></div>

</body>

</html>
